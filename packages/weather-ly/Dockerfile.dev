FROM node:16-alpine as uiBuild

WORKDIR /weather-ly

COPY ./weather-ly/package.json /weather-ly/package.json
COPY ./weather-ly/yarn.lock /weather-ly/yarn.lock

RUN yarn install --silent

COPY ./weather-ly .

RUN yarn ui:build && cd -


FROM node:16-alpine

WORKDIR /weather-ly/server

COPY ./weather-ly/server/package.json package.json
COPY ./weather-ly/server/yarn.lock yarn.lock

RUN yarn install --silent

COPY ./weather-ly/server .
COPY --from=uiBuild /weather-ly/build /weather-ly/build

CMD yarn server:dev


